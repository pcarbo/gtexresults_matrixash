---
title: "Heterogeneity"
output: html_document
---

In this document, I aim to consider tissue specificity by considering the proportional magnitude of the maximum effect size across tissues. 

```{r,echo=FALSE}
knitr::opts_chunk$set(cache=TRUE)

posterior.betas=read.table("../Data/Aug13withEDposterior.betas.txt")
maxbetas=read.table("../Data/maxbetahats.txt")
lfsr=read.table("../Data/Aug13withEDlfsr.txt")[,-1]
covmat=readRDS("../Data/covmatAug13withED.rds")
colnames(lfsr)=colnames(maxbetas)

het.norm=function(effectsize){
  t(apply(effectsize,1,function(x){
  x/x[which.max(abs(x))]
}))}


ebnorm=het.norm(effectsize=posterior.betas)
bnorm=het.norm(effectsize = maxbetas)


het.func.spec=function(normdat,threshold){
  apply(abs(normdat),1,function(x){sum(x>threshold)})}


hist(het.func.spec(ebnorm,threshold=0.5),main="Number of tissues in which normalized effect > 0.5 MaxEffect,E(B|D)", nclass=45,xlab="Number of tissues",freq=FALSE)

hist(het.func.spec(bnorm,threshold=0.5),main="Number of tissues in which normalized effect > 0.5 MaxEffect,B.mle", nclass=45,xlab="Number of tissues",freq=FALSE)

```

We can compare this to the number of tissues in which the tissue has a significant effect according to lfsr. Thus even for some 'small effects', our confidence in consistency in effects augment our belief in calling their sign correctly.

```{r, echo=FALSE}
thresh=0.05
sigmat=(lfsr<=thresh)
nsig= rowSums(sigmat)
hist(nsig[nsig>0],main="Number of tissues in which eQTl significantAccordingtoLFSR", nclass=45,xlab="Number of tissues")
```

